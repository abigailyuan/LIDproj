import math
import re
import string
from collections import defaultdict as dd


train_data = [[0.0, 0.48460213156441156, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.44129227922652936, 0.0, 0.0, 0.3242386242592802, 0.0, 0.0, 0.0, 0.4483154985245643, 0.08779024122543687, 0.0, 0.0, 0.0, 0.0, 0.0, 0.071402729530022, 0.05033307163591714, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.13344116666266403, 0.0, 0.002341073099344983, 0.2235724809874459, 0.0, 0.0, 0.0842786315764194, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.019899121344432356, 0.0, 0.0, 0.0, 0.004682146198689966, 0.0, 0.0, 0.416711011683407, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 'de'], [0.0, 0.011517021809825537, 0.0, 0.006581155319900307, 0.0, 0.0, 0.0, 0.0, 0.008226444149875382, 0.0, 0.0, 0.013162310639800614, 0.5396547362318251, 0.0, 0.0, 0.011517021809825537, 0.0, 0.0, 0.3027331447154141, 0.0, 0.0, 0.0, 0.006581155319900307, 0.0032905776599501534, 0.0, 0.0, 0.20895168140683473, 0.0, 0.0, 0.0, 0.0, 0.018098177129725845, 0.0, 0.0, 0.00493586648992523, 0.0, 0.0, 0.0032905776599501534, 0.45903558356304636, 0.3981598968539685, 0.0, 0.0, 0.0, 0.07568328617885353, 0.013162310639800614, 0.0, 0.0, 0.0, 0.0016452888299750767, 0.0, 0.0, 0.0032905776599501534, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4442279840932707, 'fa'], [0.0, 0.29991858801208704, 0.0, 0.003107964642612301, 0.0, 0.0, 0.0, 0.0, 0.4187982355920076, 0.0, 0.0, 0.28049380899576015, 0.0, 0.0, 0.0, 0.4871734577294782, 0.027194690622857634, 0.0, 0.0, 0.0, 0.0, 0.0, 0.26573097694335174, 0.06060531053093987, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.32711327863494466, 0.0, 0.011654867409796129, 0.464640714070539, 0.0, 0.0, 0.07459115142269522, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09323893927836903, 0.0, 0.0, 0.0, 0.006215929285224602, 0.0, 0.0, 0.07925309838661368, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 'en'], [0.0, 0.012838462075170039, 0.0, 0.15406154490204046, 0.15406154490204046, 0.0, 0.0, 0.0, 0.012838462075170039, 0.0, 0.0, 0.012838462075170039, 0.0, 0.0, 0.0, 0.025676924150340077, 0.0, 0.0, 0.0, 0.0, 0.0, 0.10270769660136031, 0.0, 0.0, 0.0, 0.0, 0.0, 0.680438489984012, 0.0, 0.42366924848061127, 0.0, 0.0, 0.0, 0.07703077245102023, 0.012838462075170039, 0.0, 0.25676924150340075, 0.025676924150340077, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4750230967812914, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 'ja'], [0.0, 0.009648771597265387, 0.0, 0.009648771597265387, 0.0, 0.0, 0.0, 0.0, 0.01447315739589808, 0.0, 0.0, 0.01447315739589808, 0.0, 0.0, 0.0, 0.036986957789517313, 0.0, 0.4374109790760309, 0.0, 0.0, 0.0, 0.0, 0.022513800393619235, 0.0016081285995442312, 0.3988158926869693, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.019297543194530774, 0.4953036086596232, 0.0016081285995442312, 0.02733818619225193, 0.0, 0.0, 0.011256900196809617, 0.0, 0.0, 0.0, 0.4920873514605347, 0.0, 0.0, 0.0016081285995442312, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0032162571990884624, 0.19136730334576352, 0.0, 0.3489639061010982, 0.0, 0.0, 0.0, 'bg'], [0.0, 0.0038862654955984, 0.0, 0.005829398243397599, 0.0, 0.0, 0.0, 0.0, 0.013601929234594398, 0.0, 0.0, 0.005829398243397599, 0.0, 0.0, 0.0, 0.027203858469188796, 0.0, 0.39445594780323756, 0.0, 0.0, 0.0, 0.0, 0.013601929234594398, 0.0019431327477992, 0.2254033987447072, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0077725309911968, 0.47023812496740636, 0.0019431327477992, 0.009715663738996, 0.0, 0.0, 0.0019431327477992, 0.0, 0.0, 0.0, 0.5110439126711895, 0.0, 0.0, 0.0155450619823936, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.39834221329883596, 0.0, 0.38862654955984, 0.0, 0.0, 0.0, 'ru'], [0.0, 0.00571968110120663, 0.0, 0.002859840550603315, 0.0, 0.0, 0.0, 0.0, 0.01715904330361989, 0.0, 0.0, 0.0, 0.49475241525437347, 0.0, 0.0, 0.008579521651809944, 0.0, 0.0, 0.19446915744102541, 0.0, 0.0, 0.0, 0.008579521651809944, 0.002859840550603315, 0.0, 0.0, 0.4032375176350674, 0.0, 0.0, 0.0, 0.0, 0.008579521651809944, 0.0, 0.0, 0.002859840550603315, 0.0, 0.0, 0.00571968110120663, 0.0, 0.3746391121290342, 0.0, 0.0, 0.0, 0.44613512589411713, 0.10295425982171934, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00571968110120663, 0.0, 0.0, 0.0, 0.0, 0.0, 0.45185480699532377, 'ar'], [0.0, 0.29491658568464524, 0.0, 0.006325288701011157, 0.0, 0.0, 0.0, 0.0, 0.30519517982378835, 0.0, 0.0, 0.23166369867453365, 0.0, 0.0, 0.0, 0.4158877320914836, 0.1193898242315856, 0.007906610876263946, 0.0, 0.0, 0.0, 0.0, 0.5265802843591789, 0.3763546777101639, 0.004743966525758368, 0.0, 0.0, 0.0, 0.0015813221752527893, 0.0, 0.0, 0.07195015897400192, 0.008697271963890342, 0.018185205015407078, 0.23403568193741284, 0.0, 0.0, 0.23640766520029202, 0.0, 0.0, 0.0, 0.011069255226769525, 0.0, 0.0, 0.16762015057679566, 0.0, 0.0, 0.0, 0.031626443505055786, 0.0, 0.0, 0.120180485319212, 0.0007906610876263946, 0.0, 0.0055346276133847625, 0.0, 0.0, 0.0, 'unk'], [0.5894794740481756, 0.019390772172637353, 0.003878154434527471, 0.06205047095243953, 0.0, 0.0, 0.0, 0.2559581926788131, 0.027147081041692295, 0.027147081041692295, 0.0, 0.011634463303582412, 0.0, 0.0, 0.0, 0.05429416208338459, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.06980677982149447, 0.019390772172637353, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.023268926607164824, 0.0, 0.0, 0.06980677982149447, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5545760841374283, 0.0, 0.0, 0.0, 0.0, 0.0, 0.003878154434527471, 0.08531939755960435, 0.2947397370240878, 0.0, 0.0, 0.40720621562538445, 0.0, 0.0, 0.0, 0.0, 'mr'], [0.0, 0.26685250860506066, 0.0, 0.004252629619204154, 0.0, 0.0, 0.0, 0.0, 0.37529456389476656, 0.0, 0.0, 0.2944946011298877, 0.0, 0.0, 0.0, 0.5156313413285036, 0.4018734990147925, 0.0, 0.0, 0.0, 0.0, 0.0, 0.11801047193291526, 0.13183151819532876, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.07867364795527684, 0.0, 0.006378944428806231, 0.45290505444524237, 0.0, 0.0, 0.043589453596842576, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.038273666572837386, 0.0, 0.0, 0.0, 0.017010518476816616, 0.0, 0.0, 0.165852555148962, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 'fr'], [0.0, 0.4177737641253415, 0.0, 0.0010879525107430768, 0.0, 0.0, 0.0, 0.0, 0.38187133127082, 0.0, 0.0, 0.39275085637825075, 0.0, 0.0, 0.0, 0.36555204360967386, 0.26981222266428306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.09030005839167538, 0.038078337876007694, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.21432664461638615, 0.0, 0.0021759050214861537, 0.2219423121915877, 0.0, 0.0, 0.05222172051566769, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.05113376800492461, 0.0, 0.0, 0.0, 0.004351810042972307, 0.0, 0.0, 0.4569400545120923, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 'nl'], [0.0, 0.06766917293233082, 0.0, 0.007518796992481203, 0.0, 0.37969924812030076, 0.0, 0.0, 0.041353383458646614, 0.0, 0.0, 0.03383458646616541, 0.007518796992481203, 0.0, 0.0, 0.08270676691729323, 0.0, 0.0, 0.11654135338345864, 0.40601503759398494, 0.0, 0.0, 0.022556390977443608, 0.015037593984962405, 0.0, 0.0, 0.3082706766917293, 0.0, 0.0, 0.0, 0.40977443609022557, 0.018796992481203006, 0.0, 0.0, 0.06766917293233082, 0.0, 0.0, 0.0037593984962406013, 0.5075187969924813, 0.16541353383458646, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3308270676691729, 'ur'], [0.0, 0.03681913914463891, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.06883578187910754, 0.0, 0.0, 0.09604992820340585, 0.0, 0.0, 0.0, 0.5250729408452853, 0.03201664273446862, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4994596266577105, 0.360187230762772, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0208108177774046, 0.0, 0.0, 0.056029124785320086, 0.0, 0.0, 0.5218712765718385, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0208108177774046, 0.0, 0.0, 0.0, 0.22891899555145062, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 'it'], [0.0, 0.2188964504201349, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.023416829579828383, 0.0, 0.0, 0.22805955764702426, 0.0, 0.0, 0.0, 0.2555488793276924, 0.36754241210078464, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5324783421847933, 0.03868867495797733, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.060069258487385854, 0.0, 0.0020362460504198595, 0.40928545613439177, 0.0, 0.0, 0.42659354756296053, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.057014889411756066, 0.0, 0.0, 0.0, 0.0030543690756297892, 0.0, 0.0, 0.24027703394954342, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 'es'], [0.0, 0.0, 0.0, 0.02676438637860946, 0.0, 0.0, 0.0, 0.0, 0.02676438637860946, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02676438637860946, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02676438637860946, 0.0, 0.0, 0.3747014093005324, 0.0, 0.0, 0.0, 0.0, 0.0, 0.02676438637860946, 0.0, 0.02676438637860946, 0.02676438637860946, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.642345273086627, 0.0, 0.3747014093005324, 0.3747014093005324, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4014657956791419, 0.0, 'ko'], [0.4940079820559727, 0.009106137918082445, 0.3961169994365864, 0.0, 0.0, 0.0, 0.0, 0.18667582732069013, 0.013659206877123669, 0.004553068959041223, 0.0, 0.011382672397603058, 0.0, 0.0, 0.0, 0.01593574135664428, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.01593574135664428, 0.011382672397603058, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.009106137918082445, 0.0, 0.0022765344795206113, 0.013659206877123669, 0.0, 0.0, 0.01593574135664428, 0.0, 0.0, 0.0, 0.0, 0.327820965050968, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5031141199740551, 0.30505562025576194, 0.0, 0.0, 0.33009749953048867, 0.0, 0.0, 0.0, 0.0, 'ne'], [0.5406059970783489, 0.02621119985834419, 0.24245359868968375, 0.019658399893758144, 0.0, 0.0, 0.0, 0.2227951987959256, 0.07863359957503258, 0.3341927981938884, 0.0, 0.02621119985834419, 0.0, 0.0, 0.0, 0.022934799876051164, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.019658399893758144, 0.029487599840637212, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.029487599840637212, 0.0, 0.0, 0.09173919950420466, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4292083976803861, 0.0, 0.0, 0.0, 0.0, 0.0, 0.013105599929172094, 0.07208079961044653, 0.33746919817618143, 0.009829199946879072, 0.0, 0.4062735978043349, 0.0, 0.0, 0.0, 0.0, 'hi'], [0.0, 0.058722021951470346, 0.0, 0.0, 0.0, 0.0, 0.4404151646360276, 0.0, 0.08808303292720551, 0.0, 0.5284981975632331, 0.029361010975735173, 0.0, 0.0, 0.0, 0.029361010975735173, 0.0, 0.0, 0.0, 0.0, 0.38169314268455723, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.029361010975735173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.46977617561176277, 0.38169314268455723, 0.0, 0.0, 0.0, 0.0, 0.0, 0.029361010975735173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 'th'], [0.0, 0.009787589618983562, 0.0, 0.014681384428475342, 0.0, 0.0, 0.0, 0.0, 0.014681384428475342, 0.0, 0.0, 0.014681384428475342, 0.0, 0.0, 0.0, 0.019575179237967123, 0.0, 0.2789463041410315, 0.0, 0.0, 0.0, 0.0, 0.014681384428475342, 0.004893794809491781, 0.2300083560461137, 0.0, 0.0, 0.0, 0.5040608653776534, 0.0, 0.0, 0.004893794809491781, 0.3768222003308671, 0.0, 0.009787589618983562, 0.0, 0.0, 0.009787589618983562, 0.0, 0.0, 0.0, 0.401291174378326, 0.0, 0.0, 0.009787589618983562, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3866097899498507, 0.0, 0.401291174378326, 0.0, 0.0, 0.0, 'uk'], [0.0, 0.0, 0.0, 0.1102434659256059, 0.0, 0.0, 0.0, 0.0, 0.0881947727404847, 0.0, 0.0, 0.06614607955536353, 0.0, 0.0, 0.0, 0.04409738637024235, 0.0, 0.0, 0.0, 0.0, 0.0, 0.13229215911072706, 0.0, 0.022048693185121176, 0.0, 0.0, 0.0, 0.6394121023685142, 0.0, 0.0881947727404847, 0.0, 0.04409738637024235, 0.0, 0.1984382386660906, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.7055581819238776, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 'zh'], [0.0, 0.009472398570543173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.4641475299566155, 0.45467513138607235, 0.009472398570543173, 0.009472398570543173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.009472398570543173, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3504787471100974, 0.0, 0.0, 0.0, 0.0, 0.5778163128031336, 0.0, 0.0, 0.0, 0.10419638427597491, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.3315339499690111, 0.0, 0.0, 'he']]

Ngram_set = {'ว', 'и', 'ा', '？', '다', 'а', 'a', 'ה', 'de', '！', 'ي', 'י', 'र', '는', 'я', 'е', 'ه', 'ی', 'en', 'ת', 'e', 'ㅋㅋ', 'ी', '…', 'แล้ว', 'ר', 'о', 'ם', 'n', 'на', 'की', 'і', 'o', 'RT', '。', 'میں', 'े', 'ن', 'i', 'ｗ', 'ے', 's', 'ๆ', 'di', 'ا', 'T', 'd', 'को', 't', 'م', 'た', 'त', 'ो', 'ㅋ', 'ะ', 'کے', 'و', 'r'}

test = '你好'

N = 4
K = 5

header = ['م', 'ם', 'ी', 'た', 'ㅋ', 'd', 's', 'di', 'र', 'त', 'ا', 'ה', 'о', 't', 'ن', 'ा', 'ㅋㅋ', 'ว', 'की', 'י', 'ｗ', '！', '…', 'en', 'े', 'ๆ', 'і', '？', 'ے', 'и', 'а', 'کے', '다', '는', 'T', 'ي', 'e', 'میں', 'r', 'ی', 'แล้ว', 'o', 'на', 'को', 'ר', 'RT', '。', 'و', 'ो', 'ะ', 'ه', 'е', 'i', 'я', 'n', 'a', 'de', 'ת', 'lang']

def count_Ngrams(document, N):
    """ count_trigrams takes a string and returns a dictionary of the counts 
    of trigrams within the document. """
    count_dict = dd(float)
    i = 0
    length = 1 - N
    Ngrams = []
    for word in document:
        if(len(word) < N):
            Ngrams.append(word)
        else:
            for i in range(0, len(word)-length):
                Ngram = word[i:i+N]
                if(Ngram not in Ngrams):
                    Ngrams.append(Ngram)
    
    return Ngrams

def createVector(Ngrams):
    Ngramcount = {}
    notInSet = {}
    for i in header[:-1]:
        if i not in Ngramcount.keys():
            Ngramcount[i] = 0
    for i in Ngrams:
        if i in Ngramcount.keys():
            Ngramcount[i] += 1
        else:
            if i in notInSet.keys():
                notInSet[i] += 1
            else:
                notInSet[i] = 1
    vector = []
    for i in header[:-1]:
        frequency = Ngramcount[i]
        vector.append(frequency)
        
    return vector

def computerScores(train_data, vector):
    scores = []
    for lang in train_data:
        score = 0
        for i in range(len(lang[:-1])):
            score += lang[i] * vector[i]
        scores.append((score, lang[-1]))
    return sorted(scores, reverse=True)


    
def processTest(test):
    #tokenize test data
    test = test.split()

    #clearify test data
    buffer = []
    for i in test:
        if ('@' not in i) and ('#' not in i) and ('http' not in i):
            i = re.sub('[%s]' % re.escape(string.punctuation),'',i)
            i = re.sub('\d','',i)
            if i != '':
                buffer.append(i)
    test = buffer

    #create Ngrams
    Ngrams = count_Ngrams(test, N)

    #create vector for test
    vector = createVector(Ngrams)

    #compute scores for each language
    scores = computerScores(train_data, vector)

    return scores

#######################################

scores = processTest(test)
for i in scores:
    print(i)
